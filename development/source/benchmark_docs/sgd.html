<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The SGD Deep Learning Benchmark &#8212; DACBench Documentation 0.2.1 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ac9c05f7c49ca1e1f876c6e36360ea26.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=2eb4fb78" />
    
  <link rel="preload" as="script" href="../../_static/js/index.9ea38e314b9e6d9dab77.js">

    <script src="../../_static/documentation_options.js?v=3ca669d2"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Saving &amp; Loading Benchmark Configurations" href="../modifications.html" />
    <link rel="prev" title="The CMA-ES Benchmark" href="cma.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
  <a class="navbar-brand" href="../../index.html">
  <!-- <p class="title">DACBench Documentation</p> -->
  </a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/automl/DACBench" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/automl_org?lang=de" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <div class="dropdown mt-1">
    <button type="button" class="btn btn-secondary btn-md navbar-btn dropdown-toggle" id="dLabelMore"
        data-toggle="dropdown">
        v0.2.1
        <span class="caret"></span>
    </button>
    <div class="dropdown-menu list-group-flush py-0" aria-labelledby="dLabelMore">
        <a class="list-group-item list-group-item-action" href="#">v0.2.1</a>
    </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search align-items-center" action="../../search.html" method="get" style="width: 100%;">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control btn btn-md" name="q" id="search-input"
    placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off">
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><h4 class="mt-0 mb-0"><a href="../../index.html">DACBench Documentation</a></h4>
<div class="mb-3">v0.2.1</div><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dac.html">
   Dynamic Algorithm Configuration - A Short Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../installation.html">
   How to Install DACBench
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../containers.html">
   Using DACBench Containers
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The Benchmarks:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../benchmarks.html">
   Benchmark Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="function_approximation.html">
   The Function Approximation Toy Benchmark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="luby.html">
   The Luby Toy Benchmark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="toy_sgd.html">
   The ToySGD Benchmark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fastdownward.html">
   The FastDownward Benchmark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="theory.html">
   The Theory Benchmark
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cma.html">
   The CMA-ES Benchmark
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   The SGD Deep Learning Benchmark
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Using DACBench:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../modifications.html">
   Saving &amp; Loading Benchmark Configurations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../multi_agent_dac.html">
   Multi-Agent DAC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../state_and_reward.html">
   Modifying Observations &amp; Cost
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../wrappers.html">
   Functionality through Wrappers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../logging.html">
   Logging Experiments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../plotting.html">
   Plotting results
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Misc:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../contrib.html">
   Contributing to DACBench
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cite.html">
   Citing DACBench
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dacbench.benchmarks.sgd_benchmark.SGDBenchmark">
   <code class="docutils literal notranslate">
    <span class="pre">
     SGDBenchmark
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dacbench.benchmarks.sgd_benchmark.SGDBenchmark.get_benchmark">
     <code class="docutils literal notranslate">
      <span class="pre">
       SGDBenchmark.get_benchmark()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dacbench.benchmarks.sgd_benchmark.SGDBenchmark.get_environment">
     <code class="docutils literal notranslate">
      <span class="pre">
       SGDBenchmark.get_environment()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dacbench.benchmarks.sgd_benchmark.SGDBenchmark.read_instance_set">
     <code class="docutils literal notranslate">
      <span class="pre">
       SGDBenchmark.read_instance_set()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dacbench.envs.sgd.SGDEnv">
   <code class="docutils literal notranslate">
    <span class="pre">
     SGDEnv
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dacbench.envs.sgd.SGDEnv.get_default_reward">
     <code class="docutils literal notranslate">
      <span class="pre">
       SGDEnv.get_default_reward()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dacbench.envs.sgd.SGDEnv.get_default_state">
     <code class="docutils literal notranslate">
      <span class="pre">
       SGDEnv.get_default_state()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dacbench.envs.sgd.SGDEnv.render">
     <code class="docutils literal notranslate">
      <span class="pre">
       SGDEnv.render()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dacbench.envs.sgd.SGDEnv.reset">
     <code class="docutils literal notranslate">
      <span class="pre">
       SGDEnv.reset()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dacbench.envs.sgd.SGDEnv.step">
     <code class="docutils literal notranslate">
      <span class="pre">
       SGDEnv.step()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dacbench.envs.sgd.SGDInstance">
   <code class="docutils literal notranslate">
    <span class="pre">
     SGDInstance
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dacbench.envs.sgd.forward_backward">
   <code class="docutils literal notranslate">
    <span class="pre">
     forward_backward()
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dacbench.envs.sgd.run_epoch">
   <code class="docutils literal notranslate">
    <span class="pre">
     run_epoch()
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dacbench.envs.sgd.test">
   <code class="docutils literal notranslate">
    <span class="pre">
     test()
    </span>
   </code>
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="the-sgd-deep-learning-benchmark">
<span id="sgd"></span><h1>The SGD Deep Learning Benchmark<a class="headerlink" href="#the-sgd-deep-learning-benchmark" title="Link to this heading">¶</a></h1>
<div class="line-block">
<div class="line"><strong>Task:</strong> control the learning rate in deep learning</div>
<div class="line"><strong>Cost:</strong> log differential validation loss</div>
<div class="line"><strong>Number of hyperparameters to control:</strong> one or two floats</div>
<div class="line"><strong>State Information:</strong> predictive change variance, predictive change variance, loss variance, loss variance uncertainty, current learning rate, training loss, validation loss, step, alignment, crashed</div>
<div class="line"><strong>Noise Level:</strong> fairly large</div>
<div class="line"><strong>Instance space:</strong> dataset, network architecture, optimizer</div>
</div>
<p>Built on top of PyTorch, this benchmark allows for dynamic learning rate control in deep learning.
At each step until the cutoff, i.e. after each epoch, the DAC controller provides a new learning rate value to the network.
Success is measured by decreasing validation loss.</p>
<p>This is a very flexible benchmark, as in principle all kinds of classification datasets and PyTorch compatible architectures can be included in training.
The underlying task is not easy, however, so we recommend starting with small networks and datasets and building up to harder tasks.</p>
<p id="module-dacbench.benchmarks.sgd_benchmark">Benchmark for SGD.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dacbench.benchmarks.sgd_benchmark.SGDBenchmark">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacbench.benchmarks.sgd_benchmark.</span></span><span class="sig-name descname"><span class="pre">SGDBenchmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/benchmarks/sgd_benchmark.html#SGDBenchmark"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.benchmarks.sgd_benchmark.SGDBenchmark" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../benchmarks.html#dacbench.abstract_benchmark.AbstractBenchmark" title="dacbench.abstract_benchmark.AbstractBenchmark"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractBenchmark</span></code></a></p>
<p>Benchmark with default configuration &amp; relevant functions for SGD.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dacbench.benchmarks.sgd_benchmark.SGDBenchmark.get_benchmark">
<span class="sig-name descname"><span class="pre">get_benchmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance_set_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/benchmarks/sgd_benchmark.html#SGDBenchmark.get_benchmark"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.benchmarks.sgd_benchmark.SGDBenchmark.get_benchmark" title="Link to this definition">¶</a></dt>
<dd><p>Get benchmark from the LTO paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Environment seed</p></li>
<li><p><strong>Returns</strong></p></li>
<li><p><strong>-------</strong></p></li>
<li><p><strong>env</strong> (<a class="reference internal" href="#dacbench.envs.sgd.SGDEnv" title="dacbench.envs.sgd.SGDEnv"><em>SGDEnv</em></a>) – SGD environment</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacbench.benchmarks.sgd_benchmark.SGDBenchmark.get_environment">
<span class="sig-name descname"><span class="pre">get_environment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/benchmarks/sgd_benchmark.html#SGDBenchmark.get_environment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.benchmarks.sgd_benchmark.SGDBenchmark.get_environment" title="Link to this definition">¶</a></dt>
<dd><p>Return SGDEnv env with current configuration.</p>
<section id="returns">
<h2>Returns:<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>SGDEnv</dt><dd><p>SGD environment</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacbench.benchmarks.sgd_benchmark.SGDBenchmark.read_instance_set">
<span class="sig-name descname"><span class="pre">read_instance_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/benchmarks/sgd_benchmark.html#SGDBenchmark.read_instance_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.benchmarks.sgd_benchmark.SGDBenchmark.read_instance_set" title="Link to this definition">¶</a></dt>
<dd><p>Read path of instances from config into list.</p>
</dd></dl>

</dd></dl>

<p id="module-dacbench.envs.sgd">SGD environment.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dacbench.envs.sgd.SGDEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacbench.envs.sgd.</span></span><span class="sig-name descname"><span class="pre">SGDEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/envs/sgd.html#SGDEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.envs.sgd.SGDEnv" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../multi_agent_dac.html#dacbench.abstract_env.AbstractMADACEnv" title="dacbench.abstract_env.AbstractMADACEnv"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractMADACEnv</span></code></a></p>
<p>The SGD DAC Environment implements the problem of dynamically configuring
the learning rate hyperparameter of a neural network optimizer
(more specifically, torch.optim.AdamW) for a supervised learning task.
While training, the model is evaluated after every epoch.</p>
<p>Actions correspond to learning rate values in [0,+inf[
For observation space check <cite>observation_space</cite> method docstring.
For instance space check the <cite>SGDInstance</cite> class docstring
Reward:</p>
<blockquote>
<div><p>negative loss of model on test_loader of the instance       if done
crash_penalty of the instance                               if crashed
0                                                           otherwise</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="dacbench.envs.sgd.SGDEnv.get_default_reward">
<span class="sig-name descname"><span class="pre">get_default_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/dacbench/envs/sgd.html#SGDEnv.get_default_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.envs.sgd.SGDEnv.get_default_reward" title="Link to this definition">¶</a></dt>
<dd><p>The default reward function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>_</strong> (<em>_type_</em>) – Empty parameter, which can be used when overriding</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated reward</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacbench.envs.sgd.SGDEnv.get_default_state">
<span class="sig-name descname"><span class="pre">get_default_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../../_modules/dacbench/envs/sgd.html#SGDEnv.get_default_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.envs.sgd.SGDEnv.get_default_state" title="Link to this definition">¶</a></dt>
<dd><p>Default state function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>_</strong> (<em>_type_</em>) – Empty parameter, which can be used when overriding</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The current state</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacbench.envs.sgd.SGDEnv.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'human'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/envs/sgd.html#SGDEnv.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.envs.sgd.SGDEnv.render" title="Link to this definition">¶</a></dt>
<dd><p>Render progress.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacbench.envs.sgd.SGDEnv.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/envs/sgd.html#SGDEnv.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.envs.sgd.SGDEnv.reset" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the neural network, data loaders, etc. for given/random next task.
Also perform a single forward/backward pass,
not yet updating the neural network parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dacbench.envs.sgd.SGDEnv.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/envs/sgd.html#SGDEnv.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.envs.sgd.SGDEnv.step" title="Link to this definition">¶</a></dt>
<dd><p>Update the parameters of the neural network using the given learning rate lr,
in the direction specified by AdamW, and if not done (crashed/cutoff reached),
performs another forward/backward pass (update only in the next step).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dacbench.envs.sgd.SGDInstance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacbench.envs.sgd.</span></span><span class="sig-name descname"><span class="pre">SGDInstance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction_of_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_validation_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/envs/sgd.html#SGDInstance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.envs.sgd.SGDInstance" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>SGD Instance.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dacbench.envs.sgd.forward_backward">
<span class="sig-prename descclassname"><span class="pre">dacbench.envs.sgd.</span></span><span class="sig-name descname"><span class="pre">forward_backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/envs/sgd.html#forward_backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.envs.sgd.forward_backward" title="Link to this definition">¶</a></dt>
<dd><p>Do a forward and a backward pass for given <cite>model</cite> for <cite>loss_function</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mini batch training loss per data point</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dacbench.envs.sgd.run_epoch">
<span class="sig-prename descclassname"><span class="pre">dacbench.envs.sgd.</span></span><span class="sig-name descname"><span class="pre">run_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/envs/sgd.html#run_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.envs.sgd.run_epoch" title="Link to this definition">¶</a></dt>
<dd><p>Run a single epoch of training for given <cite>model</cite> with <cite>loss_function</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dacbench.envs.sgd.test">
<span class="sig-prename descclassname"><span class="pre">dacbench.envs.sgd.</span></span><span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_percentage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/dacbench/envs/sgd.html#test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dacbench.envs.sgd.test" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate given <cite>model</cite> on <cite>loss_function</cite>.</p>
<p>Percentage defines how much percentage of the data shall be used.
If nothing given the whole data is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Batch validation loss per data point</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>test_losses</p>
</dd>
</dl>
</dd></dl>

</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="cma.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">The CMA-ES Benchmark</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../modifications.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Saving &amp; Loading Benchmark Configurations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.9ea38e314b9e6d9dab77.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Theresa Eimer, Maximilian Reimer.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a>
8.0.2. Template is modified version of <a
href="https://pydata-sphinx-theme.readthedocs.io">PyData Sphinx Theme</a>. <br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>